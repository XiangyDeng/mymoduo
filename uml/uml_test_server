@startuml
scale 2
skinparam dpi 800
' 继承：  <|--  --|>  '
' 聚合：  o--  --o  '
' 组合：  *-- --*  '
' 双向关联：  --  '

class EchoServer {
    -EventLoop* loop_  //指针
    -TcpServer server_ 
    -OnConnection() // 连接断开回调
    -OnMessage() // 读写回调
    -start() // 开启loop 
}

interface EchoServer_ctor {
    1. 注册回调函数: server_.setConnectionCallback()
                    server_.setMessageCallback()
    2. 设置线程数量: server_.setThreadNum(3)
}

interface OnConnection {
    1. 调用TcpConnectionPtr类连接:  conn->connected()
}

interface OnMessage {
    1. 用户设定读写回调函数操作: 
        std::string msg = buf->retrieveAllAsString()
        conn->send(msg) 
}

Entity main {
    1. 定义端口
    2. 定义ip地址 //默认为127.0.0.1
    3. 设置server: EchoServer server(&loop, addr, "EchoServer-01")
    4. 启动服务器server:  server.start()
    5. 开启mainLoop循环:  loop.loop()
}

EchoServer -- EchoServer_ctor
EchoServer -- OnConnection
EchoServer -- OnMessage

@enduml